<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Likelihood for DAMOCLES model — DAMOCLES_loglik • DAMOCLES</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Likelihood for DAMOCLES model — DAMOCLES_loglik"><meta name="description" content="Computes likelihood for the presence-absence data of species in a local
community for a given phylogeny of species in the region."><meta property="og:description" content="Computes likelihood for the presence-absence data of species in a local
community for a given phylogeny of species in the region."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAMOCLES</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Likelihood for DAMOCLES model</h1>

      <div class="d-none name"><code>DAMOCLES_loglik.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes likelihood for the presence-absence data of species in a local
community for a given phylogeny of species in the region.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DAMOCLES_loglik</span><span class="op">(</span></span>
<span>  <span class="va">phy</span>,</span>
<span>  <span class="va">pa</span>,</span>
<span>  <span class="va">pars</span>,</span>
<span>  pchoice <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  edgeTList <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  methode <span class="op">=</span> <span class="st">"analytical"</span>,</span>
<span>  model <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  Mlist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cond <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>phylogeny in phylo format</p></dd>


<dt id="arg-pa">pa<a class="anchor" aria-label="anchor" href="#arg-pa"></a></dt>
<dd><p>presence-absence table with the first column the species labels
and the second column the presence (1) or absence (0) of the species</p></dd>


<dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>Vector of model parameters:<br><code>pars[1]</code> corresponds to mu (extinction rate in local community)<br><code>pars[2]</code> corresponds to gamma_0 in formula
gamma(t) = gamma_0/(1 + gamma_1 * t) where gamma(t) is immigration rate
into local community)<br><code>pars[3]</code> corresponds to
gamma_1 in formula gamma(t) = gamma_0/(1 + gamma_1 * t) where gamma(t) is
immigration rate into local community)</p></dd>


<dt id="arg-pchoice">pchoice<a class="anchor" aria-label="anchor" href="#arg-pchoice"></a></dt>
<dd><p>sets the p-value to optimize:<br>
pchoice == 0 corresponds to
the sum of p_0f + p_1f<br>
pchoice == 1 corresponds to p_0f<br>
pchoice == 2 corresponds to p_1f<br></p></dd>


<dt id="arg-edgetlist">edgeTList<a class="anchor" aria-label="anchor" href="#arg-edgetlist"></a></dt>
<dd><p>list of edge lengths that need to be succesively pruned; if
not specified, it will computed using compute_edgeTList</p></dd>


<dt id="arg-methode">methode<a class="anchor" aria-label="anchor" href="#arg-methode"></a></dt>
<dd><p>method used to solve the ODE. Either 'analytical' for the analytical
solution, 'Matrix' for matrix exponentiation using package Matrix or 'expm' using
package 'expm' or any of the numerical solvers, used in deSolve, or any of the solvers
used in odeint (preceded by 'odeint'), e.g. 'odeint::runge_kutta_cash_karp54',
'odeint::runge_kutta_fehlberg78', 'odeint::runge_kutta_dopri5',
'odeint::runge_kutta_bulirsch_stoer'</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>model used. Default is 0 (standard null model). Other options are 1 (binary traits)
2 (trinary environmental trait) or 3 (diversity-dependent colonization - beta version)</p></dd>


<dt id="arg-mlist">Mlist<a class="anchor" aria-label="anchor" href="#arg-mlist"></a></dt>
<dd><p>list of M matrices that can be specified when methode = 'analytical'. If set
at NULL (default) and methode = 'analytical', Mlist will be computed.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Whether intermediate output should be printed. Default is FALSE.</p></dd>


<dt id="arg-cond">cond<a class="anchor" aria-label="anchor" href="#arg-cond"></a></dt>
<dd><p>Whether likelihood should be conditioned on non-empty community. Default is no
conditioning.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The loglikelihood</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pigot, A.L. &amp; R.S. Etienne (2015). A new dynamic null model for
phylogenetic community structure. Ecology Letters 18: 153-163.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="DAMOCLES_ML.html">DAMOCLES_ML</a></code> <code><a href="DAMOCLES_sim.html">DAMOCLES_sim</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rampal S. Etienne</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">#TEST IT WORKS</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape" class="external-link">ape</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">phy</span> <span class="op">=</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rcoal</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pars</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.label</span>,<span class="va">pa</span><span class="op">)</span>,nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">phy</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span>,ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># - without a root edge</span></span></span>
<span class="r-in"><span>  <span class="va">loglik</span> <span class="op">=</span> <span class="fu">DAMOCLES_loglik</span><span class="op">(</span><span class="va">phy</span>,<span class="va">pa</span>,<span class="va">pars</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">loglik</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -175.094</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># - with a root edge</span></span></span>
<span class="r-in"><span>  <span class="va">phy</span><span class="op">$</span><span class="va">root.edge</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="va">loglik</span> <span class="op">=</span> <span class="fu">DAMOCLES_loglik</span><span class="op">(</span><span class="va">phy</span>,<span class="va">pa</span>,<span class="va">pars</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">loglik</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -175.5636</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rampal S. Etienne.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

