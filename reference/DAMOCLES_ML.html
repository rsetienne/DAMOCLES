<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Maximization of the loglikelihood under the DAMOCLES model — DAMOCLES_ML • DAMOCLES</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximization of the loglikelihood under the DAMOCLES model — DAMOCLES_ML"><meta name="description" content="This function computes the maximum likelihood estimates of the parameters of
the DAMOCLES model for a given phylogeny and presence-absence data.  It also
outputs the corresponding loglikelihood that can be used in model
comparisons."><meta property="og:description" content="This function computes the maximum likelihood estimates of the parameters of
the DAMOCLES model for a given phylogeny and presence-absence data.  It also
outputs the corresponding loglikelihood that can be used in model
comparisons."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAMOCLES</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Maximization of the loglikelihood under the DAMOCLES model</h1>

      <div class="d-none name"><code>DAMOCLES_ML.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function computes the maximum likelihood estimates of the parameters of
the DAMOCLES model for a given phylogeny and presence-absence data.  It also
outputs the corresponding loglikelihood that can be used in model
comparisons.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DAMOCLES_ML</span><span class="op">(</span></span>
<span>  <span class="va">phy</span>,</span>
<span>  <span class="va">pa</span>,</span>
<span>  <span class="va">initparsopt</span>,</span>
<span>  idparsopt <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">initparsopt</span><span class="op">)</span>,</span>
<span>  parsfix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  idparsfix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  idparsequal <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pars2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">1e-04</span>, <span class="fl">1e-05</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>  optimmethod <span class="op">=</span> <span class="st">"simplex"</span>,</span>
<span>  pchoice <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  edgeTList <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  methode <span class="op">=</span> <span class="st">"analytical"</span>,</span>
<span>  model <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  num_cycles <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cond <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phy">phy<a class="anchor" aria-label="anchor" href="#arg-phy"></a></dt>
<dd><p>phylogeny in phylo format</p></dd>


<dt id="arg-pa">pa<a class="anchor" aria-label="anchor" href="#arg-pa"></a></dt>
<dd><p>presence-absence table.<br> The first column contains the labels of
the species (corresponding to the tip labels in the phylogeny.<br> The second
column contains the presence (1) or absence (0) of species in the local
community.</p></dd>


<dt id="arg-initparsopt">initparsopt<a class="anchor" aria-label="anchor" href="#arg-initparsopt"></a></dt>
<dd><p>The initial values of the parameters that must be
optimized</p></dd>


<dt id="arg-idparsopt">idparsopt<a class="anchor" aria-label="anchor" href="#arg-idparsopt"></a></dt>
<dd><p>The ids of the parameters that must be optimized, e.g. 1:2
for extinction rate, and offset of immigration rate The ids are defined as
follows: <br> id == 1 corresponds to mu (extinction rate) <br> id == 2
corresponds to gamma_0 (offset of immigration rate) <br> id == 3 corresponds
to gamma_1 (parameter controlling decline in immigration rate with time)</p></dd>


<dt id="arg-parsfix">parsfix<a class="anchor" aria-label="anchor" href="#arg-parsfix"></a></dt>
<dd><p>The values of the parameters that should not be optimized.
See idparsfix.</p></dd>


<dt id="arg-idparsfix">idparsfix<a class="anchor" aria-label="anchor" href="#arg-idparsfix"></a></dt>
<dd><p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if mu and gamma_1 should not be optimized, but only gamma_0. In
that case idparsopt must be c(2). The default is to fix all parameters not
specified in idparsopt.</p></dd>


<dt id="arg-idparsequal">idparsequal<a class="anchor" aria-label="anchor" href="#arg-idparsequal"></a></dt>
<dd><p>The ids of the parameters that should be set equal to the
first parameter of the same type.</p></dd>


<dt id="arg-pars-">pars2<a class="anchor" aria-label="anchor" href="#arg-pars-"></a></dt>
<dd><p>Vector of settings: <br><code>pars2[1]</code> sets the relative tolerance in the parameters <br><br><code>pars2[2]</code> sets the relative tolerance in the function <br><br><code>pars2[3]</code> sets the absolute tolerance in the parameters <br><br><code>pars2[4]</code> sets the maximum number of iterations</p></dd>


<dt id="arg-optimmethod">optimmethod<a class="anchor" aria-label="anchor" href="#arg-optimmethod"></a></dt>
<dd><p>Method used in optimization of the likelihood. Current
default is 'subplex'. Alternative is 'simplex' (default of previous version)</p></dd>


<dt id="arg-pchoice">pchoice<a class="anchor" aria-label="anchor" href="#arg-pchoice"></a></dt>
<dd><p>sets the p-value to optimize: <br>
pchoice == 0 corresponds to the sum of p_0f + p_1f <br>
pchoice == 1 corresponds to p_0f <br>
pchoice == 2 corresponds to p_1f <br></p></dd>


<dt id="arg-edgetlist">edgeTList<a class="anchor" aria-label="anchor" href="#arg-edgetlist"></a></dt>
<dd><p>list of edge lengths that need to be succesively pruned; if
not specified, it will computed using compute_edgeTList</p></dd>


<dt id="arg-methode">methode<a class="anchor" aria-label="anchor" href="#arg-methode"></a></dt>
<dd><p>method used to solve the ODE. Either 'analytical' for the analytical
solution, 'Matrix' for matrix exponentiation using package Matrix or 'expm' using
package 'expm' or any of the numerical solvers, used in deSolve.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>model used. Default is 0 (standard null model). Other options are 1 (binary traits)
2 (trinary environmental trait) or 3 (diversity-dependent colonization - beta version)</p></dd>


<dt id="arg-num-cycles">num_cycles<a class="anchor" aria-label="anchor" href="#arg-num-cycles"></a></dt>
<dd><p>the number of cycles of opimization. If set at Inf, it will
do as many cycles as needed to meet the tolerance set for the target function.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Whether intermediate output should be printed. Default is FALSE.</p></dd>


<dt id="arg-cond">cond<a class="anchor" aria-label="anchor" href="#arg-cond"></a></dt>
<dd><p>Whether likelihood should be conditioned on non-empty community. Default is no
conditioning.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>


<dl><dt>mu</dt>
<dd><p>gives the maximum likelihood estimate of mu</p></dd>

<dt>gamma_0</dt>
<dd><p>gives the maximum likelihood estimate of gamma_0</p></dd>

<dt>gamma_1</dt>
<dd><p>gives the maximum likelihood estimate of gamma_1</p></dd>

<dt>loglik</dt>
<dd><p>gives the maximum loglikelihood</p></dd>

<dt>df</dt>
<dd><p>gives the number of estimated parameters, i.e. degrees of feedom</p></dd>

<dt>conv</dt>
<dd><p>gives a message on convergence of optimization; conv = 0 means convergence</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The output is a dataframe containing estimated parameters and maximum
loglikelihood.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pigot, A.L. &amp; R.S. Etienne (2015). A new dynamic null model for
phylogenetic community structure. Ecology Letters 18: 153-163.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="DAMOCLES_loglik.html">DAMOCLES_loglik</a></code> <code><a href="DAMOCLES_sim.html">DAMOCLES_sim</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Rampal S. Etienne</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rampal S. Etienne.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

