[{"path":"https://rsetienne.github.io/DAMOCLES/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Rampal S. Etienne. Maintainer.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pigot RSE&AL (2025). DAMOCLES: Dynamic Assembly Model Colonization, Local Extinction Speciation. R package version 3.1, https://rsetienne.github.io/DAMOCLES/.","code":"@Manual{,   title = {DAMOCLES: Dynamic Assembly Model of Colonization, Local Extinction and Speciation},   author = {Rampal S. Etienne & Alex L. Pigot},   year = {2025},   note = {R package version 3.1},   url = {https://rsetienne.github.io/DAMOCLES/}, }"},{"path":"https://rsetienne.github.io/DAMOCLES/index.html","id":"damocles","dir":"","previous_headings":"","what":"Dynamic Assembly Model of Colonization, Local Extinction and Speciation","title":"Dynamic Assembly Model of Colonization, Local Extinction and Speciation","text":"Dynamic Assembly Model Colonization, Local Extinction Speciation R. development version official release CRAN.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/index.html","id":"installing-damocles","dir":"","previous_headings":"","what":"Installing DAMOCLES","title":"Dynamic Assembly Model of Colonization, Local Extinction and Speciation","text":"DAMOCLES package stable version CRAN development version GitHub.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/index.html","id":"from-cran","dir":"","previous_headings":"Installing DAMOCLES","what":"From CRAN","title":"Dynamic Assembly Model of Colonization, Local Extinction and Speciation","text":"within R, :","code":"install.packages(\"DAMOCLES\")"},{"path":"https://rsetienne.github.io/DAMOCLES/index.html","id":"from-github","dir":"","previous_headings":"Installing DAMOCLES","what":"From GitHub","title":"Dynamic Assembly Model of Colonization, Local Extinction and Speciation","text":"Install DAMOCLES GitHub repository running:","code":"install.packages(\"remotes\") remotes::install_github(\"rsetienne/DAMOCLES\")"},{"path":[]},{"path":"https://rsetienne.github.io/DAMOCLES/index.html","id":"from-cran-1","dir":"","previous_headings":"Using DAMOCLES as a package dependency","what":"From CRAN","title":"Dynamic Assembly Model of Colonization, Local Extinction and Speciation","text":"DESCRIPTION file, add DAMOCLES normal package. package directly uses DAMOCLES: package uses DAMOCLES peripherals (e.g. vignettes tests):","code":"Imports:   DAMOCLES Suggests:   DAMOCLES"},{"path":"https://rsetienne.github.io/DAMOCLES/index.html","id":"from-github-1","dir":"","previous_headings":"Using DAMOCLES as a package dependency","what":"From GitHub","title":"Dynamic Assembly Model of Colonization, Local Extinction and Speciation","text":"","code":"Remotes:   rsetienne/DAMOCLES"},{"path":"https://rsetienne.github.io/DAMOCLES/index.html","id":"git-branching-model","dir":"","previous_headings":"","what":"git branching model","title":"Dynamic Assembly Model of Colonization, Local Extinction and Speciation","text":"master: build always pass. @rsetienne control develop master merges. develop: merge topic branches, merge master @rsetienne iff build passes. ## Contributors DAMOCLES originally developed Rampal S. Etienne Alex Pigot Additionally others working expanding DAMOCLES TECE lab, University Groningen.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Dynamic Assembly Model of Colonization, Local Extinction and Speciation","text":"Pigot, . L., & Etienne, R. S. (2015). new dynamic null model phylogenetic community structure. Ecology Letters, 18(2), 153-163. https://doi.org/10.1111/ele.12395","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_ML.html","id":null,"dir":"Reference","previous_headings":"","what":"Maximization of the loglikelihood under the DAMOCLES model — DAMOCLES_ML","title":"Maximization of the loglikelihood under the DAMOCLES model — DAMOCLES_ML","text":"function computes maximum likelihood estimates parameters DAMOCLES model given phylogeny presence-absence data.  also outputs corresponding loglikelihood can used model comparisons.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_ML.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Maximization of the loglikelihood under the DAMOCLES model — DAMOCLES_ML","text":"","code":"DAMOCLES_ML(   phy,   pa,   initparsopt,   idparsopt = 1:length(initparsopt),   parsfix = NULL,   idparsfix = NULL,   idparsequal = NULL,   pars2 = c(0.001, 1e-04, 1e-05, 1000),   optimmethod = \"simplex\",   pchoice = 0,   edgeTList = NULL,   methode = \"analytical\",   model = 0,   num_cycles = 1,   verbose = FALSE,   cond = 0 )"},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_ML.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Maximization of the loglikelihood under the DAMOCLES model — DAMOCLES_ML","text":"phy phylogeny phylo format pa presence-absence table. first column contains labels species (corresponding tip labels phylogeny. second column contains presence (1) absence (0) species local community. initparsopt initial values parameters must optimized idparsopt ids parameters must optimized, e.g. 1:2 extinction rate, offset immigration rate ids defined follows:  id == 1 corresponds mu (extinction rate)  id == 2 corresponds gamma_0 (offset immigration rate)  id == 3 corresponds gamma_1 (parameter controlling decline immigration rate time) parsfix values parameters optimized. See idparsfix. idparsfix ids parameters optimized, e.g. c(1,3) mu gamma_1 optimized, gamma_0. case idparsopt must c(2). default fix parameters specified idparsopt. idparsequal ids parameters set equal first parameter type. pars2 Vector settings: pars2[1] sets relative tolerance parameters pars2[2] sets relative tolerance function pars2[3] sets absolute tolerance parameters pars2[4] sets maximum number iterations optimmethod Method used optimization likelihood. Current default 'subplex'. Alternative 'simplex' (default previous version) pchoice sets p-value optimize:  pchoice == 0 corresponds sum p_0f + p_1f  pchoice == 1 corresponds p_0f  pchoice == 2 corresponds p_1f edgeTList list edge lengths need succesively pruned; specified, computed using compute_edgeTList methode method used solve ODE. Either 'analytical' analytical solution, 'Matrix' matrix exponentiation using package Matrix 'expm' using package 'expm' numerical solvers, used deSolve. model model used. Default 0 (standard null model). options 1 (binary traits) 2 (trinary environmental trait) 3 (diversity-dependent colonization - beta version) num_cycles number cycles opimization. set Inf, many cycles needed meet tolerance set target function. verbose Whether intermediate output printed. Default FALSE. cond Whether likelihood conditioned non-empty community. Default conditioning.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_ML.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Maximization of the loglikelihood under the DAMOCLES model — DAMOCLES_ML","text":"mu gives maximum likelihood estimate mu gamma_0 gives maximum likelihood estimate gamma_0 gamma_1 gives maximum likelihood estimate gamma_1 loglik gives maximum loglikelihood df gives number estimated parameters, .e. degrees feedom conv gives message convergence optimization; conv = 0 means convergence","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_ML.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Maximization of the loglikelihood under the DAMOCLES model — DAMOCLES_ML","text":"output dataframe containing estimated parameters maximum loglikelihood.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_ML.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Maximization of the loglikelihood under the DAMOCLES model — DAMOCLES_ML","text":"Pigot, .L. & R.S. Etienne (2015). new dynamic null model phylogenetic community structure. Ecology Letters 18: 153-163.","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_ML.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Maximization of the loglikelihood under the DAMOCLES model — DAMOCLES_ML","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_bootstrap.html","id":null,"dir":"Reference","previous_headings":"","what":"Phylogenetic community structure hypothesis test — DAMOCLES_bootstrap","title":"Phylogenetic community structure hypothesis test — DAMOCLES_bootstrap","text":"function computes maximum likelihood estimates colonisation local extinction rate given phylogeny presence-absence data DAMOCLES model.  rate estimates used simulate null communities DAMOCLES model.  Standardized effect size mean nearest taxon distance (mntd), mean phylogentic distance (mpd) loglikelihood calculated comparison, standardised effect sizes also calculated relative \"Random-Draw\" null model .e. presence absence randomised across tips","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_bootstrap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phylogenetic community structure hypothesis test — DAMOCLES_bootstrap","text":"","code":"DAMOCLES_bootstrap(   phy = ape::rcoal(10),   pa = matrix(c(phy$tip.label, sample(c(0, 1), ape::Ntip(phy), replace = T)), nrow =     ape::Ntip(phy), ncol = 2),   initparsopt = c(0.1, 0.1),   idparsopt = 1:length(initparsopt),   parsfix = NULL,   idparsfix = NULL,   pars2 = c(0.001, 1e-04, 1e-05, 1000),   pchoice = 0,   runs = 999,   estimate_pars = FALSE,   conf.int = 0.95 )"},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_bootstrap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Phylogenetic community structure hypothesis test — DAMOCLES_bootstrap","text":"phy phylogeny phylo format pa presence-absence table. first column contains labels species (corresponding tip labels phylogeny. second column contains presence (1) absence (0) species local community. initparsopt initial values parameters must optimized idparsopt ids parameters must optimized, e.g. 1:2 extinction rate, offset immigration rate ids defined follows:  id == 1 corresponds mu (extinction rate)  id == 2 corresponds gamma_0 (offset immigration rate) parsfix values parameters optimized. See idparsfix. idparsfix ids parameters optimized, e.g. c(1) mu optimized, gamma_0. case idparsopt must c(2). default fix parameters specified idparsopt. pars2 Vector settings: pars2[1] sets relative tolerance parameters pars2[2] sets relative tolerance function pars2[3] sets absolute tolerance parameters pars2[4] sets maximum number iterations pchoice sets p-value optimize root state simulate (default pchoice = 0)  pchoice == 0 correspond optimizing sum p_0f + p_1f, simulating equal number root states 0 1  pchoice == 1 correspond optimizing p_0f, simulating root state 0 pchoice == 2 correspond optimizing p_1f, simulating root state 1 runs number null communities generate. estimate_pars Whether estimate parameters simulated datasets (default = FALSE). conf.int width conifdence intervals calculated bootstrapped parameter estimates","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_bootstrap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Phylogenetic community structure hypothesis test — DAMOCLES_bootstrap","text":"summary_table mu gives maximum likelihood estimate mu confidence intervals brackets estimate_pars = TRUE gamma_0 gives maximum likelihood estimate gamma_0 confidence intervals brackets bootstrap=TRUE loglik gives maximum loglikelihood df gives number estimated parameters, .e. degrees feedom conv gives message convergence optimization; conv = 0 means convergence n.obs gives number species locally present observed community mntd.obs gives MNTD observed community mpd.obs gives MPD observed community runs gives number null communities simulated mntd.mean.RD mean MNTD null communities generated \"Random Draw\" model mntd.sd.RD standard deviation MNTD null communities generated \"Random Draw\" model mntd.obs.z.RD standardized effect size MNTD compared null communities generated \"Random Draw\" model (= -1*(mntd.obs - mntd.mean.RD)/ mntd.sd.RD) mntd.obs.rank.RD rank observed MNTD compared null communities generated \"Random Draw\" model mntd.obs.q.RD quantile observed MNTD vs. null communities (= mntd.obs.rank.RD /runs + 1) mpd.mean.RD mean MPD null communities generated \"Random Draw\" model mpd.sd.RD standard deviation MPD null communities generated \"Random Draw\" model mpd.obs.z.RD standardized effect size MPD compared null communities generated \"Random Draw\" model (= -1*(mpd.obs - mpd.mean.RD)/ mpd.sd.RD) mpd.obs.rank.RD rank observed MPD compared null communities generated \"Random Draw\" model mpd.obs.q.RD quantile observed MPD vs. null communities (= mpd.obs.rank.RD /runs + 1) n.mean.DAMOCLES mean number species locally present null communities generated DAMOCLES mntd.mean.DAMOCLES mean MNTD null communities generated DAMOCLES mntd.sd.DAMOCLES standard deviation MNTD null communities generated DAMOCLES mntd.obs.z.DAMOCLES standardized effect size MNTD compared null communities generated DAMOCLES (= -1*(mntd.obs - mntd.mean.DAMOCLES)/ mntd.sd.DAMOCLES) mntd.obs.rank.DAMOCLES rank observed MNTD compared null communities generated DAMOCLES mntd.obs.q.DAMOCLES quantile observed MNTD vs. null communities (= mntd.obs.rank.DAMOCLES /runs + 1) mpd.mean.DAMOCLES mean MPD null communities generated DAMOCLES mpd.sd.DAMOCLES standard deviation MPD null communities generated DAMOCLES mpd.obs.z.DAMOCLES standardized effect size MPD compared null communities generated DAMOCLES (= -1*(mpd.obs - mpd.mean.DAMOCLES)/ mpd.sd.DAMOCLES) mpd.obs.rank.DAMOCLES rank observed MPD compared null communities generated DAMOCLES mpd.obs.q.DAMOCLES quantile observed MPD vs. null communities (= mpd.obs.rank.DAMOCLES /runs + 1) loglik.mean.DAMOCLES mean loglikelihoods null communities generated DAMOCLES loglik.sd.DAMOCLES standard deviation loglikelihoods null communities generated DAMOCLES loglik.obs.z.DAMOCLES standardized effect size loglikelihood compared null communities generated DAMOCLES (= -1*(loglik.obs - loglik.mean.DAMOCLES)/ loglik.sd.DAMOCLES) loglik.obs.rank.DAMOCLES rank observed loglikelihood compared null communities generated DAMOCLES loglik.obs.q.DAMOCLES quantile observed loglikelihoods vs. null communities (= loglik.obs.rank.DAMOCLES /runs + 1) null_community_data run gives simulation run root.state.print gives state ancestral species local community assumed simulation, .e. present (1) absent (0) n gives number species locally present observed community n.RD gives number species locally present null community generated \"Random Draw\" model mntd.RD gives MNTD null community generated \"Random Draw\" model mpd.RD gives MPD null community generated \"Random Draw\" model n.DAMOCLES gives number species locally present null community generated DAMOCLES mntd.DAMOCLES gives MNTD null community generated DAMOCLES mpd.DAMOCLES gives MPD null community generated DAMOCLES loglik.DAMOCLES gives maximum loglikelihood null community generated DAMOCLES mu.DAMOCLES gives maximum likelihood estimate mu null community generated DAMOCLES gamma_0.DAMOCLES gives maximum likelihood estimate gamma_0 null community generated DAMOCLES","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_bootstrap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Phylogenetic community structure hypothesis test — DAMOCLES_bootstrap","text":"output list two dataframes. first dataframe, summary_table, contains summary results. second dataframe, null_community_data, contains decsriptive statistics null community.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_bootstrap.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Phylogenetic community structure hypothesis test — DAMOCLES_bootstrap","text":"Pigot, .L. & R.S. Etienne (2015). new dynamic null model phylogenetic community structure. Ecology Letters 18: 153-163.","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_bootstrap.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Phylogenetic community structure hypothesis test — DAMOCLES_bootstrap","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_loglik.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood for DAMOCLES model — DAMOCLES_loglik","title":"Likelihood for DAMOCLES model — DAMOCLES_loglik","text":"Computes likelihood presence-absence data species local community given phylogeny species region.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_loglik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood for DAMOCLES model — DAMOCLES_loglik","text":"","code":"DAMOCLES_loglik(   phy,   pa,   pars,   pchoice = 0,   edgeTList = NULL,   methode = \"analytical\",   model = 0,   Mlist = NULL,   verbose = FALSE,   cond = 0 )"},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_loglik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood for DAMOCLES model — DAMOCLES_loglik","text":"phy phylogeny phylo format pa presence-absence table first column species labels second column presence (1) absence (0) species pars Vector model parameters:pars[1] corresponds mu (extinction rate local community)pars[2] corresponds gamma_0 formula gamma(t) = gamma_0/(1 + gamma_1 * t) gamma(t) immigration rate local community)pars[3] corresponds gamma_1 formula gamma(t) = gamma_0/(1 + gamma_1 * t) gamma(t) immigration rate local community) pchoice sets p-value optimize: pchoice == 0 corresponds sum p_0f + p_1f pchoice == 1 corresponds p_0f pchoice == 2 corresponds p_1f edgeTList list edge lengths need succesively pruned; specified, computed using compute_edgeTList methode method used solve ODE. Either 'analytical' analytical solution, 'Matrix' matrix exponentiation using package Matrix 'expm' using package 'expm' numerical solvers, used deSolve, solvers used odeint (preceded 'odeint'), e.g. 'odeint::runge_kutta_cash_karp54', 'odeint::runge_kutta_fehlberg78', 'odeint::runge_kutta_dopri5', 'odeint::runge_kutta_bulirsch_stoer' model model used. Default 0 (standard null model). options 1 (binary traits) 2 (trinary environmental trait) 3 (diversity-dependent colonization - beta version) Mlist list M matrices can specified methode = 'analytical'. set NULL (default) methode = 'analytical', Mlist computed. verbose Whether intermediate output printed. Default FALSE. cond Whether likelihood conditioned non-empty community. Default conditioning.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_loglik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood for DAMOCLES model — DAMOCLES_loglik","text":"loglikelihood","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_loglik.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Likelihood for DAMOCLES model — DAMOCLES_loglik","text":"Pigot, .L. & R.S. Etienne (2015). new dynamic null model phylogenetic community structure. Ecology Letters 18: 153-163.","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_loglik.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Likelihood for DAMOCLES model — DAMOCLES_loglik","text":"Rampal S. Etienne","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_loglik.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Likelihood for DAMOCLES model — DAMOCLES_loglik","text":"","code":"#TEST IT WORKS   library(ape)   phy = ape::rcoal(100)   pars = c(0.5,0.1,0.1)   pa = rbinom(100,c(0,1),0.5)   pa = matrix(c(phy$tip.label,pa),nrow = length(phy$tip.label),ncol = 2)    # - without a root edge   loglik = DAMOCLES_loglik(phy,pa,pars)   loglik #> [1] -175.094    # - with a root edge   phy$root.edge = 2   loglik = DAMOCLES_loglik(phy,pa,pars)   loglik #> [1] -175.5636"},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_sim.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulating DAMOCLES — DAMOCLES_sim","title":"Simulating DAMOCLES — DAMOCLES_sim","text":"Simulates DAMOCLES","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_sim.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulating DAMOCLES — DAMOCLES_sim","text":"","code":"DAMOCLES_sim(   phy,   gamma_0,   gamma_td,   mu,   sigma,   psiBranch,   psiTrait,   z,   phi,   traitOpt,   br0,   br_td,   nTdim,   root.state,   root.trait.state,   plotit = FALSE,   keepExtinct = FALSE )"},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_sim.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulating DAMOCLES — DAMOCLES_sim","text":"phy phylogeny phylo format gamma_0 initial per lineage rate immigration (gamma) gamma_td time dependency gamma mu per lineage rate local extinction sigma probability local (.e. -situ) speciation psiBranch phylogenetic distance gamma half gamma_0 psiTrait trait distance gamma half gamma_0 z shape increase gamma increasing trait phylogenetic distance phi rate decline gamma distance trait optima traitOpt trait value gamma = gamma_0 br0 Brownian rate parameter br_td rate temporal decline Brownian rate parameter nTdim number independent trait dimensions root.state geographic state ancestor .e. present (1) absent(0) root.trait.state trait value ancestor plotit whether plot phylogeny timing immigration/local extinction events keepExtinct whether retain data extinct lineages","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_sim.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulating DAMOCLES — DAMOCLES_sim","text":"list two tables. first table contains following columns: first column contains vector tip labels phylogeny last column contains presence (1) absence (0) species second table dimensions d x N d number trait dimensions N number species. contains trait values.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_sim.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Simulating DAMOCLES — DAMOCLES_sim","text":"Pigot, .L. & R.S. Etienne (2015). new dynamic null model phylogenetic community structure. Ecology Letters 18: 153-163.","code":""},{"path":[]},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_sim.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulating DAMOCLES — DAMOCLES_sim","text":"Alex L. Pigot","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/DAMOCLES_sim.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulating DAMOCLES — DAMOCLES_sim","text":"","code":"#create random phylogeny library(ape) phy = ape::rcoal(10)      #run DAMOCLES     out = DAMOCLES_sim(   phy,   gamma_0 = 1.5,   gamma_td =0,   mu = 0,   sigma = 0,   psiBranch = 0,   psiTrait = 0,   z = 10,   phi = 0,   traitOpt = 1,   br0 = 0.1,   br_td = -0.1,   nTdim = 2,   root.state = 1,   root.trait.state = 0,   plotit = FALSE,   keepExtinct = FALSE   )  #the output consists of a list     patable = out[[1]] # the first element is the presence absence table traits = out[[2]] # this is a matrix of traits values  #show presence/absence on the tree patable$col = rep(\"black\",dim(patable)[1]) patable$col[which(patable$state == 1)] = \"red\" plot(phy,tip.col = patable$col)"},{"path":"https://rsetienne.github.io/DAMOCLES/reference/HERACLES_ImportanceSampling.html","id":null,"dir":"Reference","previous_headings":"","what":"Importance Sampling from the HERACLES model — HERACLES_ImportanceSampling","title":"Importance Sampling from the HERACLES model — HERACLES_ImportanceSampling","text":"Computes likelihood metrics randomly sampled presence-absence data species local community given phylogeny species region.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/HERACLES_ImportanceSampling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Importance Sampling from the HERACLES model — HERACLES_ImportanceSampling","text":"","code":"HERACLES_ImportanceSampling(   nSamples,   n,   regionalSpecies,   S_regional,   p = n/S_regional,   pa,   phy,   phydist,   parsDAM,   Mlist = NULL,   model,   pchoice,   samptype,   edgeObj = NULL,   methode = \"analytical\",   traitdist = NULL )"},{"path":"https://rsetienne.github.io/DAMOCLES/reference/HERACLES_ImportanceSampling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Importance Sampling from the HERACLES model — HERACLES_ImportanceSampling","text":"nSamples number samples used importance sampling n number species local community regionalSpecies list species present regional community (SP) S_regional number species regional species pool p probability used binomial distribution pa presence-absence table first column species labels second column presence (1) absence (0) species phy phylogeny phylo format phydist TBD parsDAM Vector model parameters:pars[1] corresponds mu (extinction rate local community)pars[2] corresponds gamma_0 formula gamma(t) = gamma_0/(1 + gamma_1 * t) gamma(t) immigration rate local community)pars[3] corresponds gamma_1 formula gamma(t) = gamma_0/(1 + gamma_1 * t) gamma(t) immigration rate local community) Mlist list M matrices can specified methode = 'analytical'. set NULL (default) methode = 'analytical', Mlist computed. model model used. Default 0 (standard null model). options 1 (binary traits) 2 (trinary environmental trait) 3 (diversity-dependent colonization - beta version) pchoice sets p-value optimize: pchoice == 0 corresponds sum p_0f + p_1f pchoice == 1 corresponds p_0f pchoice == 2 corresponds p_1f samptype Type sampling distribution, can either 'uniform' 'binomial' case local samples uniformly binomially generated, local diversity stochastic variable, 'fixed' case observed local diversity used configurations consistent diversity sampled edgeObj list edge lengths need successively pruned; specified, computed using compute_edgeTList methode method used solve ODE. Either 'analytical' analytical solution, 'Matrix' matrix exponentiation using package Matrix 'expm' using package 'expm' numerical solvers, used deSolve. traitdist TBD","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/HERACLES_ImportanceSampling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Importance Sampling from the HERACLES model — HERACLES_ImportanceSampling","text":"list containing attributes loglikelihood importance sampling, metrics (mntd mpd, TBD)","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/HERACLES_ImportanceSampling.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Importance Sampling from the HERACLES model — HERACLES_ImportanceSampling","text":"Pigot, .L. & R.S. Etienne (2015). new dynamic null model phylogenetic community structure. Ecology Letters 18: 153-163.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/HERACLES_ImportanceSampling.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Importance Sampling from the HERACLES model — HERACLES_ImportanceSampling","text":"Rampal S. Etienne & Alex L. Pigot","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/HERACLES_ImportanceSampling.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Importance Sampling from the HERACLES model — HERACLES_ImportanceSampling","text":"","code":"cat('No examples yet') #TBD #> No examples yet"},{"path":"https://rsetienne.github.io/DAMOCLES/reference/NWPrimates_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Dated phylogenetic tree of the New World Primates in nexus format and presence-absence matrix for species in Manu — NWPrimates_data","title":"Dated phylogenetic tree of the New World Primates in nexus format and presence-absence matrix for species in Manu — NWPrimates_data","text":"list two elements. .  phy dated molecular phylogeny 94 species New World Primates extracted maximum likelihood tree (AUTOsoft dated) Springer et al. (2012). 1 time unit = 100 million years. pa presence-absence matrix NW Primates Manu Solari et al. (2006). first column indicate species tip labels second column indicates presence (1) absence (0).","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/NWPrimates_data.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dated phylogenetic tree of the New World Primates in nexus format and presence-absence matrix for species in Manu — NWPrimates_data","text":"list two elements. first element (phy) primate phylogeny nexus format. second element (pa) presence-absence matrix 94 rows 2 columns.","code":""},{"path":"https://rsetienne.github.io/DAMOCLES/reference/NWPrimates_data.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Dated phylogenetic tree of the New World Primates in nexus format and presence-absence matrix for species in Manu — NWPrimates_data","text":"Solari, S., Pacheco, V., Luna, L., Velazco, P.M. & Patterson, B.D. 2006 Mammals manu biosphere reserve. Fieldiana Zoology 110, 13-22. Springer, M.S., Meredith, R.W., Gatesy, J., Emerling, C.., Park, J., Rabosky, D.L., Stadler, T., Steiner, C., Ryder, O.., Janecka, J.E., et al. 2012 Macroevolutionary dynamics historical biogeography primate diversification inferred species supermatrix. Plos One 7. (doi:ARTN e49521 DOI 10.1371/journal.pone.0049521).","code":""},{"path":[]}]
